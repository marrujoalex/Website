
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.8.0">
    
    
      
        <title>Hashing using CryptoKitten - OpenKitten Docs</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-bfecc7305d.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../.." title="OpenKitten Docs" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Utility
                </span>
              
            
            Hashing using CryptoKitten
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    OpenKitten Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/" title="Leopard Basics" class="md-nav__link">
      Leopard Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/advanced-routing/" title="Advanced routing" class="md-nav__link">
      Advanced routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/errors/" title="Errors" class="md-nav__link">
      Errors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/config/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/request-response/" title="Request & Response" class="md-nav__link">
      Request & Response
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/cookies-sessions/" title="Cookies & Sessions" class="md-nav__link">
      Cookies & Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/middlewares/" title="Middlwares" class="md-nav__link">
      Middlwares
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/websocket/" title="WebSocket" class="md-nav__link">
      WebSocket
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../puma/" title="HTTP client" class="md-nav__link">
      HTTP client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/Multipart/" title="Forms and file uploading" class="md-nav__link">
      Forms and file uploading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leopard/cache/" title="Caching" class="md-nav__link">
      Caching
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Utility
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Utility
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cheetah/" title="JSON using Cheetah" class="md-nav__link">
      JSON using Cheetah
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../schrodinger/" title="Async using Schrodinger" class="md-nav__link">
      Async using Schrodinger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mailkitten/" title="SMTP using MailKitten" class="md-nav__link">
      SMTP using MailKitten
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lynx/" title="Plain HTTP using Lynx" class="md-nav__link">
      Plain HTTP using Lynx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ocelot/" title="JWT using Ocelot" class="md-nav__link">
      JWT using Ocelot
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Hashing using CryptoKitten
      </label>
    
    <a href="./" title="Hashing using CryptoKitten" class="md-nav__link md-nav__link--active">
      Hashing using CryptoKitten
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#support" title="Support" class="md-nav__link">
    Support
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-hash" title="Using a hash" class="md-nav__link">
    Using a hash
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bulk-hashing" title="'Bulk' hashing" class="md-nav__link">
    'Bulk' hashing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental" title="Incremental" class="md-nav__link">
    Incremental
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#password-hashing" title="Password hashing" class="md-nav__link">
    Password hashing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pbkdf2_hmac" title="PBKDF2_HMAC" class="md-nav__link">
    PBKDF2_HMAC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lynx/TCP/" title="TCP/SSL using Lynx" class="md-nav__link">
      TCP/SSL using Lynx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lynx/remote/" title="Testing remotes using Lynx" class="md-nav__link">
      Testing remotes using Lynx
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Third Party
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Third Party
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../third-party/jobs/" title="Jobs" class="md-nav__link">
      Jobs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#support" title="Support" class="md-nav__link">
    Support
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-hash" title="Using a hash" class="md-nav__link">
    Using a hash
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bulk-hashing" title="'Bulk' hashing" class="md-nav__link">
    'Bulk' hashing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental" title="Incremental" class="md-nav__link">
    Incremental
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#password-hashing" title="Password hashing" class="md-nav__link">
    Password hashing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pbkdf2_hmac" title="PBKDF2_HMAC" class="md-nav__link">
    PBKDF2_HMAC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="hashing">Hashing</h1>
<p>Hashing is the process of one-way encryption. It's an encryption that can't be reverted.</p>
<p>This is particularly useful for verifying information. One way hashes are employed is by hashing a message and verifying the message to output the same resulting hash on arrival. If the hash and/or message were tampered with or have been modified during transport, the results of hashing the file would not result in the same hash, making the information invalid.</p>
<p>The same is used for password hashing. The original password is not important, it poses a security risk on the user in case of data theft, for example, on a security breach of the information system (like a website).</p>
<p>Heavily and securely hashing a password is necessary to prevent brute forces.</p>
<h2 id="support">Support</h2>
<p>CryptoKitten currently supports the following hashes:</p>
<ul>
<li>MD5</li>
<li>SHA1</li>
<li>SHA224</li>
<li>SHA256</li>
<li>SHA384</li>
<li>SHA512</li>
</ul>
<p>It also supports HMAC and PBKDF2 for message authentication and password hashing.</p>
<h2 id="using-a-hash">Using a hash</h2>
<p>All of the hashes described above have the same API and support two methods of hashing.</p>
<h3 id="bulk-hashing">'Bulk' hashing</h3>
<p>Hashing the entire message in one go is simple and natural, it doesn't require extra work. You'll need to enter the data as binary. This means Strings also need to be converted to binary. A common method of converting a string to binary is this:</p>
<pre><code class="swift">let binaryMessage = [UInt8](binaryMessage.utf8)
</code></pre>

<p>To bulk hash binary data:</p>
<pre><code class="swift">let hashedMessage0 = MD5.hash(binaryMessage)
let hashedMessage1 = SHA1.hash(binaryMessage)
let hashedMessage2 = SHA224.hash(binaryMessage)
let hashedMessage3 = SHA256.hash(binaryMessage)
let hashedMessage4 = SHA384.hash(binaryMessage)
let hashedMessage5 = SHA512.hash(binaryMessage)
</code></pre>

<p>Do <em>not</em> use basic hashes for passwords. They will be easily <a href="https://en.wikipedia.org/wiki/Brute-force_attack">brute-forced</a>.</p>
<h3 id="incremental">Incremental</h3>
<p>Larger messages need to be copied around a lot. In a 1GB video, it means copying around 1GB of data. This makes the process unnecessarily really heavy. Instead of hashing the whole 1GB in one go, which would cost 2-3GB, you could pass around the buffer, for example, as a pointer.</p>
<p>When working with streams of incoming/outgoing data, you can also stream the data chunk by chunk to the hashing algorithm.</p>
<p>Before getting the hash, you'll need to finalize the hash, which will finish calculating the hash. This is <em>required</em>. Once you know the final block, you can pass it to finalize entirely.</p>
<pre><code class="swift">// Create the context first
let context = MD5()

for fileData in file {
  context.update(fileData)
}

// The data to hash
let lastBlock: UnsafeBufferPointer&lt;UInt8&gt; = ...

// Hash the block of data
context.finalize(fileData)

// the hash as hexadecimal
let hash = context.hash.hexString
</code></pre>

<p>If the final block is already hashed, you still need to finalize it by calling finalize, even if there's an empty buffer of data to hash.</p>
<h2 id="password-hashing">Password hashing</h2>
<p>For password hashing we currently only support PBKDF2 with HMAC.</p>
<h3 id="pbkdf2_hmac">PBKDF2_HMAC</h3>
<p>Hashing a password using PBKDF2 requires a hashing algorithm. You can select one generically like this:</p>
<pre><code class="swift">// with MD5
PBKDF2_HMAC&lt;MD5&gt;

// with SHA1
PBKDF2_HMAC&lt;SHA1&gt;

// with SHA512
PBKDF2_HMAC&lt;SHA512&gt;
</code></pre>

<p>You can derive a key from the PBKDF2_HMAC. This requires three parameters.</p>
<p>The password is needed in binary. You can get the binary data from a string like below:</p>
<pre><code class="swift">let binaryPassword = [UInt8](password.utf8)
</code></pre>

<p>Additionally, a <em>random</em> salt is needed. This salt <em>must</em> be randomly generated, <em>must</em> not be static and <em>must</em> be stored with the password in the database. Losing the salt means it's impossible to validate the stored (encrypted) password.</p>
<pre><code class="swift">let hash = PBKDF2_HMAC&lt;SHA512&gt;.derive(fromPassword: binaryPassword, saltedWith: randomSalt).hexString
</code></pre>

<p>To validate it you can repeat the process.</p>
<pre><code class="swift">let verifiedHash = PBKDF2_HMAC&lt;SHA512&gt;.derive(fromPassword: binaryPassword, saltedWith: randomSalt).hexString

let passwordCorrect = (hash == verifiedHash)
</code></pre>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../ocelot/" title="JWT using Ocelot" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                JWT using Ocelot
              </span>
            </div>
          </a>
        
        
          <a href="../../lynx/TCP/" title="TCP/SSL using Lynx" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                TCP/SSL using Lynx
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-1d6ee6ee6c.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>